---
title: "Growth Measures"
author: "Jeff Huang"
date: "7/27/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)

growth_data <- read.csv("data/CA_SEDA_long.csv") 

```

```{r function definition}

# 3-8
# 3-8 math
# 3-8 english
# 3-5
# 5-8

single_calc <- function (low_grade, high_grade) {
  ela_diff = high_grade$ela - low_grade$ela
  math_diff = high_grade$math - low_grade$math
  return(tuple(math_diff, ela_diff))
}

merged_calc <- function (low_grade, high_grade) {
  low_grade %>% mutate(score = mean(ela, math))
  high_grade %>% mutate(score = mean(ela, math))
  return (high_grade$score - low_grade$score)
}


test <- growth_data %>% 
  filter(grade %in% c(3,8)) %>% 
  group_by(leaidC, grade, year, subject) %>% 
  mutate()
  View()
  mutate(`5yr`= )



# for row in nrows(dataset):
#   if i > 0:
#     single or merged calc
#   else mutate(empty)
# 
# 
# eda on jumps


# would merge diff cohorts
# first look at cohorts and identify big jumps - distr at each grade
# 
# jumps by cohort
# 
# then avg across cohort, but between subjects to get avg mnall
# 
# 
# then merge w other group, and do rf on efficiency - & on gaps

# large jumps, large 

```

```{r density distribution}

# EDA

generic <- growth_data %>% 
  select(1:9, -fips, -stateabb)

for (i in 3:8) {
  data = subset(generic, grade == i)
  print(ggplot(data, aes(mn_all, color = subject)) +
  geom_density() + 
  labs(title = paste("Distribution of students in grade", i, sep = " ")) + 
  scale_x_continuous(name = "Achievement Level",
                           breaks = 0:15,
                           limits=c(0, 15)))
}

```


```{r}


# match 3 & 5
```


